<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" 
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="{{url_for('static', filename='main.css')}}">
    <title>Dashboard</title>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- navbar starts -->
            <div class="col-lg-12 navbar p-2">
                <a href="#" id="title">
                    Job <big class='head'>Scheduler</big> App<span class="blinker">_</span>
                </a>
                <div class="col-lg-6 text-right options-navbar">
                    <button class="btn btn-outline-primary btn-sm" onclick="show_schedule_frame();">Schedule a Job</button>
                    <button class="btn btn-primary btn-sm" onclick="show_view_jobs_frame();">View Scheduled Jobs</button>
                    <span id="account" data-toggle="off" onclick = "show_user_option(this);">
                        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="#1f2421" class="bi bi-person-lines-fill" viewBox="0 0 16 16">
                            <path d="M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-5 6s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zM11 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5zm.5 2.5a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1h-4zm2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1h-2zm0 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1h-2z"/>
                          </svg>
                    </span>
                    <div id="user_options">
                        <ul>
                            <a href="#" onclick="return false;"><li>Change Password</li></a>
                            <a href="#"><li>Logout</li></a>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- navbar ends  -->

            <!-- add job form starts -->
            <div class="col-lg-2"></div>
            <div class="col-lg-8 " id="add-job-form">
                <div class="row" style="vertical-align:middle;">
                    <div class="col-sm-5 heading">
                        <span id="row1">Let us</span>
                        <span class="head" id="row2">schedule</span>
                        <span>your job<b class="blinker">_</b></span>
                    </div>
                
                    <div class="col-sm-7 text-center" style="padding: 30px; padding-top:10px; padding-bottom: 10px;">
                        <h5>Configure you job here.</h5>
                        <div class="notify">
                            <div class="col-lg-12 alert-box" id="scheduler_alert_box" style="color: #dce1dee7;margin-bottom: 5px;">Notifications Here</div>
                        </div>
                        <form action="{{url_for('api.add_job')}}" method="post" class="config-form" style="text-align: left;">
                            <label for="options">Select the type of job you want to schedule</label>
                            <select name="job_type" id="options" class="form-control" required>
                                <option value="0">-- Select type of job --</option>
                                <option value="1">Nikto server Scan</option>
                                <option value="2">Nikto website Scan</option>
                                <option value="3">Zap api Scan</option>
                            </select>
                            <input type="text" name="command" id="command" class="form-control" placeholder="Type your command here" required>
                            <div class="row">
                                <div class="col-sm-6">
                                    <label for="date">Date</label>
                                    <input type="date" name="date" id="date" class="form-control col-sm-6" required>
                                </div>
                                <div class="col-sm-6">
                                    <label for="time">Time</label>
                                    <input type="time" name="time" id="time" class="form-control col-sm-6" required>
                                </div>
                            </div>
                            <input type="text" name="ref_name" id="ref_name" class="form-control" placeholder="Give your job a reference name (optional)">
                            <button type="submit" class="btn btn-primary col-sm-12 mt-2" style="border-radius: 30px; font-weight: bold;">Schedule your job</button>
                        </form>
                    </div>
                </div>
            </div>
            <!-- add job form ends -->

            <!-- view job pannel starts -->
            <div class="col-lg-12" id="view-jobs-frame">
                <div class="row">
                    <div class="col-lg-9">
                        <h2>All Jobs</h2>
                        <!-- TYPE, DESCRIPTION,  TESTDATE, TESTTIME, TOOLNAME -->
                        <table class="table table-hover" style="position: relative;overflow: scroll;">
                            <thead class="bg-dark text-light">
                              <tr>
                                <th scope="col">#</th>
                                <th scope="col">Type</th>
                                <th scope="col">Ref. Name</th>
                                <th scope="col">Date</th>
                                <th scope="col">Time</th>
                                <th scope="col">Tool Used</th>
                                <th scope="col">*</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <th scope="row">1</th>
                                <td>Website</td>
                                <td>My first Test</td>
                                <td>2022-02-17</td>
                                <td>04:18AM</td>
                                <td>Zap Api</td>
                                <td>
                                    <a href="#">View</a>
                                </td>
                              </tr>
                            </tbody>
                          </table>

                        <div class="col-lg-12 text-end">
                            <button class="btn btn-primary" style="border-radius: 30px;">Load More</button>
                        </div>
                    </div>
                    <div class="col-lg-3 filter-option">
                        <h4>Filters</h4>
                        <ul >
                            <li>All jobs</li>
                            <li>
                                <span>Nikto Server Scans</span>
                                <ul>
                                    <li>Today</li>
                                    <li>Last Week</li>
                                    <li>Last Month</li>
                                    <li>Last Year</li>
                                </ul>
                            </li>
                            <li>
                                <span>Nikto Website Scans</span>
                                <ul>
                                    <li>Today</li>
                                    <li>Last Week</li>
                                    <li>Last Month</li>
                                    <li>Last Year</li>
                                </ul>
                            </li>
                            <li>
                                <span>Zap API Scans</span>
                                <ul>
                                    <li>Today</li>
                                    <li>Last Week</li>
                                    <li>Last Month</li>
                                    <li>Last Year</li>
                                </ul>
                            </li>

                        </ul>
                    </div>
                </div>
            </div>
            <!-- view job pannel ends -->
        </div>
    </div>
</body>
<script src="{{url_for('static', filename='dashboard.js')}}"></script>
<script>
    window.onload = function(){
        var alert_box = document.querySelector(".alert-box");
        var scheduler_alert_box = document.querySelector("#scheduler_alert_box")
        var i = 0;
        {% with messages = get_flashed_messages(with_categories = True) %}
            {% if messages %}
                {% for category,message in messages %}
                    var text = {{message|tojson}};
                    var type = {{category|tojson}};
                    var class_type = type.split(' ');
                    var alert_html = '<div class=" col-lg-12 alert alert-'+ "info" +' alert-dismissible fade show" role="alert"><span id="alt-item'+i+'"></span></div>'
                    if (class_type[1] == "scheduler_alert_box"){
                        scheduler_alert_box.innerText = "";
                        scheduler_alert_box.style.border="none";
                        scheduler_alert_box.insertAdjacentHTML("beforeend",alert_html);
                    }
                    else
                        alert_box.insertAdjacentHTML("beforeend",alert_html);
                    document.getElementById('alt-item'+i).innerText = text;
                    i++;
                {% endfor %}
            {% endif %}
        {% endwith %}
    }

</script>
</html>